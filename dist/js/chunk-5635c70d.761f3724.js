(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5635c70d"],{"159b":function(e,t,n){var r=n("da84"),a=n("fdbc"),i=n("17c2"),o=n("9112");for(var c in a){var s=r[c],u=s&&s.prototype;if(u&&u.forEach!==i)try{o(u,"forEach",i)}catch(l){u.forEach=i}}},"15fd":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("a4d3"),n("c975"),n("b64b");function r(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function a(e,t){if(null==e)return{};var n,a,i=r(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}},"17c2":function(e,t,n){"use strict";var r=n("b727").forEach,a=n("a640"),i=n("ae40"),o=a("forEach"),c=i("forEach");e.exports=o&&c?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},"189e":function(e,t,n){},"28ee":function(e,t,n){},4160:function(e,t,n){"use strict";var r=n("23e7"),a=n("17c2");r({target:"Array",proto:!0,forced:[].forEach!=a},{forEach:a})},5530:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("a4d3"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b");var r=n("ade3");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},"7abd":function(e,t,n){},"7f56":function(e,t,n){"use strict";var r=n("7abd"),a=n.n(r);a.a},ade3:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},b64b:function(e,t,n){var r=n("23e7"),a=n("7b0b"),i=n("df75"),o=n("d039"),c=o((function(){i(1)}));r({target:"Object",stat:!0,forced:c},{keys:function(e){return i(a(e))}})},c975:function(e,t,n){"use strict";var r=n("23e7"),a=n("4d64").indexOf,i=n("a640"),o=n("ae40"),c=[].indexOf,s=!!c&&1/[1].indexOf(1,-0)<0,u=i("indexOf"),l=o("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:s||!u||!l},{indexOf:function(e){return s?c.apply(this,arguments)||0:a(this,e,arguments.length>1?arguments[1]:void 0)}})},d179:function(e,t,n){"use strict";var r=n("189e"),a=n.n(r);a.a},dbb4:function(e,t,n){var r=n("23e7"),a=n("83ab"),i=n("56ef"),o=n("fc6a"),c=n("06cf"),s=n("8418");r({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var t,n,r=o(e),a=c.f,u=i(r),l={},f=0;while(u.length>f)n=a(r,t=u[f++]),void 0!==n&&s(l,t,n);return l}})},e018:function(e,t,n){"use strict";var r=n("28ee"),a=n.n(r);a.a},e3fa:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("b775"),a=function(){return r["a"].get("/api/system/aliyun/getOssSign")}},e439:function(e,t,n){var r=n("23e7"),a=n("d039"),i=n("fc6a"),o=n("06cf").f,c=n("83ab"),s=a((function(){o(1)})),u=!c||s;r({target:"Object",stat:!0,forced:u,sham:!c},{getOwnPropertyDescriptor:function(e,t){return o(i(e),t)}})},eff3:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"found"},[n("div",{staticClass:"release-btn"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showEdit=!0}}},[e._v("创建内容")])],1),n("div",{staticClass:"table-wrap"},[n("dataTable",{attrs:{list:e.list},on:{update:e.update,refresh:e.refresh}}),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.pageInfo.index,"page-size":e.pageInfo.page_size,total:e.pageInfo.count},on:{"current-change":e.handlePageChange}})],1)],1),n("CreateBanner",{attrs:{show:e.showEdit,info:e.editInfo},on:{update:e.update,refresh:e.refresh}})],1)},a=[],i=n("15fd"),o=(n("96cf"),n("1da1")),c=n("5530"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"data-table"},[n("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,"max-height":"550",border:"","header-cell-class-name":"table-header"}},[n("el-table-column",{attrs:{prop:"name",label:"图片",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"flex",on:{click:function(n){return e.showImgFn(t.row.data)}}},[n("img",{staticClass:"banner-img",attrs:{src:e._f("initSrc")(t.row.feed_detail)}})])]}}])}),n("el-table-column",{attrs:{label:"文字"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.row.feed_detail.description))])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.editBanner(t.row)}}},[e._v("编辑")]),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.confirmDel(t.row)}}},[e._v("删除")])]}}])})],1),n("el-dialog",{attrs:{visible:e.showImg},on:{"update:visible":function(t){e.showImg=t}}},[n("img",{staticClass:"big-banner",attrs:{src:e.src}})])],1)},u=[],l=n("2f62"),f=n("b775"),d=function(e){return f["a"].post("/api/admin/feedAdmin/getFeedList",e)},p=function(e){return f["a"].post("/api/admin/feedAdmin/createFeed",e)},m=function(e){return f["a"].post("/api/admin/feedAdmin/deleteFeed",e)},h=function(e){return f["a"].post("/api/admin/feedAdmin/updateFeed",e)},b={name:"data-table",props:{list:{type:Array,default:function(){return[]}},type:{type:[String,Array],default:"0"}},data:function(){return{delList:[],tableData:[],showImg:!1,src:""}},created:function(){},watch:{list:function(e){this.tableData=e}},methods:Object(c["a"])(Object(c["a"])({},Object(l["b"])("product",{setStore:"update"})),{},{editBanner:function(e){this.$emit("update","editInfo",e),this.$emit("update","showEdit",!0)},showImgFn:function(e){if(!e)return"";var t=JSON.parse(e);this.src=t.image,this.showImg=!0},hideImgFn:function(){this.showImg=!1},confirmDel:function(e){var t=this;this.$confirm("此操作将永久删除该内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.delBanner(e)})).catch((function(){}))},delBanner:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.feed_base_info.feed_id,n.next=3,m({feed_id:r});case 3:a=n.sent,i=a.errorCode,0===i&&t.$emit("refresh");case 6:case"end":return n.stop()}}),n)})))()}}),filters:{initSrc:function(e){var t=e.image_list[0];return t?t&&t.image:""}},mounted:function(){this.tableData=this.list}},g=b,v=(n("e018"),n("2877")),w=Object(v["a"])(g,s,u,!1,null,"6da436d7",null),O=w.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"create-banner"},[n("el-dialog",{attrs:{visible:e.show,width:"540px",title:e.title},on:{close:e.cancel}},[n("el-form",{ref:"bannerForm",staticClass:"base-form",attrs:{"label-position":e.labelPosition,"label-width":"100px",model:e.formInfo,rules:e.rules}},[n("el-form-item",{attrs:{label:"描述文案",prop:"content"}},[n("el-input",{staticClass:"medium",attrs:{type:"textarea",rows:2},model:{value:e.formInfo.content,callback:function(t){e.$set(e.formInfo,"content",t)},expression:"formInfo.content"}})],1),n("el-form-item",{attrs:{label:"展示图片",prop:"image"}},[n("el-upload",{attrs:{action:"#","file-list":e.formInfo.image,limit:1,"on-change":e.mainHandleChange,"list-type":"picture-card","http-request":e.uploadImg},scopedSlots:e._u([{key:"file",fn:function(t){var r=t.file;return n("div",{},[n("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:r.url,alt:""}}),n("span",{staticClass:"el-upload-list__item-actions"},[n("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(r)}}},[n("i",{staticClass:"el-icon-zoom-in"})]),e.disabled?e._e():n("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleDownload(r)}}},[n("i",{staticClass:"el-icon-download"})]),e.disabled?e._e():n("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(r,"main_image")}}},[n("i",{staticClass:"el-icon-delete"})])])])}}])},[n("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1)],1),n("div",{staticClass:"btn-wrap"},[n("el-button",{staticClass:"close-btn",on:{click:e.cancel}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.vertiry}},[e._v(e._s(e.title))])],1),n("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1)},I=[],_=(n("a4d3"),n("e01a"),n("99af"),n("d81d"),n("b0c0"),n("e3fa")),j=n("19e7"),x=n("9b15"),C=n.n(x),k={name:"create-banner",props:{show:{type:Boolean,default:!0},info:{type:[Object,null],default:function(){return null}}},data:function(){return{labelPosition:"right",formInfo:{image:[],content:"",link:"",sort:""},dialogImageUrl:"",dialogVisible:!1,disabled:!1,rules:{content:[{required:!0,message:"请输入文字描述",trigger:"blur"}],image:[{required:!0,message:"请上传展示图片",trigger:"blur"}]}}},computed:{title:function(){var e="创建发现页内容";return this.syncInfo&&(e="编辑内容"),e},syncInfo:function(){return this.info}},methods:{cancel:function(){this.formInfo={image:[],content:""},this.$emit("update","showEdit",!1),this.$emit("update","editInfo",null)},mainHandleChange:function(e,t){this.formInfo.image=t},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleDownload:function(e){console.log(e)},beforeUpload:function(){return!1},handleRemove:function(){this.formInfo.image=[]},getSign:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i,o,c,s,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(_["a"])();case 2:n=t.sent,r=n.errorCode,a=n.data,0===r&&(e.sign=a,i=a.securityToken,o=a.accessKeyId,c=a.accessKeySecret,s=a.bucket,u=a.endpoint,l=new C.a({endpoint:u,accessKeyId:o,accessKeySecret:c,bucket:s,stsToken:i}),e.client=l);case 6:case"end":return t.stop()}}),t)})))()},uploadImg:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=e.file,a=Object(j["a"])("".concat(r.uid,"-").concat(r.name)),i="ipxmall/".concat(a),o=new FormData,o.append("file",r),t.client.put(i,r).then((function(t){var n=t.res;200===n.status?(e.url=n.requestUrls,e.onSuccess(n)):e.onError(n)}));case 6:case"end":return n.stop()}}),n)})))()},initInfo:function(){var e=this.syncInfo;if(!e)return!1;var t=e.feed_detail,n=t.image_list.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{url:e.image})}));this.formInfo={image:n,content:t.description}},vertiry:function(){var e=this;this.$refs.bannerForm.validate((function(t){if(!t)return!1;if(0===e.formInfo.image.length)return e.$message.error("请上传图片");var n=e.formInfo,r=n.content,a=n.image,i=e.getImgSrc(a)[0],o={content:r,image:i.content};if(e.syncInfo)return e.updateBannerFn(o),!1;e.createBannerFn(o)}))},getImgSrc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.length?e.map((function(e,t){var n={id:t,type:"image"};return e.response?n.content=e.response.requestUrls[0]:n.content=e.url,n})):""},createBannerFn:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,p(e);case 2:r=n.sent,a=r.errorCode,0===a&&(t.$emit("refresh"),t.cancel());case 5:case"end":return n.stop()}}),n)})))()},updateBannerFn:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.syncInfo.feed_base_info.feed_id,n.next=3,h(Object(c["a"])(Object(c["a"])({},e),{},{feed_id:r}));case 3:a=n.sent,i=a.errorCode,0===i&&(t.$emit("refresh"),t.cancel());case 6:case"end":return n.stop()}}),n)})))()}},watch:{show:function(e){if(!e)return!1;this.initInfo()}},mounted:function(){this.getSign()}},S=k,E=(n("d179"),Object(v["a"])(S,y,I,!1,null,"414cf714",null)),P=E.exports,D={name:"Found",props:{msg:String},components:{dataTable:O,CreateBanner:P},data:function(){return{pageInfo:{index:0,count:50,page_size:10,has_more:!0},list:[],editInfo:null,showEdit:!1}},methods:{handleClick:function(){this.loadInfo()},update:function(e,t){this[e]=t},remove:function(){this.loadInfo(this.pageInfo)},handlePageChange:function(e){e-=1,this.loadInfo(Object(c["a"])(Object(c["a"])({},this.pageInfo),{},{index:e}))},loadInfo:function(){var e=arguments,t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:t.pageInfo,n.next=3,d(r);case 3:a=n.sent,i=a.errorCode,o=a.data,0===i&&(t.list=o.feed_info_list,t.pageInfo=o.page_info);case 7:case"end":return n.stop()}}),n)})))()},refresh:function(){var e=this.pageInfo,t=e.index,n=Object(i["a"])(e,["index"]);t-=1,this.loadInfo(Object(c["a"])(Object(c["a"])({},n),{},{index:t}))}},created:function(){this.loadInfo(this.pageInfo)}},F=D,R=(n("7f56"),Object(v["a"])(F,r,a,!1,null,"84940eae",null));t["default"]=R.exports}}]);
//# sourceMappingURL=chunk-5635c70d.761f3724.js.map